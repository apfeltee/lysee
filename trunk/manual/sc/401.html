<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>Lysee 参考手册 - 4.1.嵌入内核</title>
<meta name="author" content="libudi@hotmail.com">
<meta name="copyright" content="copyright 2003-2010 LiBUDI(libudi@hotmail.com)">
<link href="index.css" rel="stylesheet" type="text/css">
<link href="logo.ico" rel="Shortcut Icon">
</head>
<body> 
<table width="760" border="0" align="center" cellpadding="0" cellspacing="8"> 
  <tr> 
    <td align="left" valign="middle"> <table width="100%"  border="0" cellspacing="0" cellpadding="0"> 
        <tr> 
          <td rowspan="2" align="left" valign="top"><a href="http://www.lysee.net"><img src="logo.png" width="490" height="86" border="0"></a></td> 
          <td align="right" valign="top"><a href="index.html">Lysee 参考手册</a></td> 
        </tr> 
        <tr> 
          <td align="right" valign="bottom"> 小巧、快速、可靠、跨平台<br> 
            Lysee 脚本引擎</td> 
        </tr> 
      </table></td> 
  </tr> 
  <tr> 
    <td class="footer_line"><a href="400.html">4.嵌入式开发</a> - <strong>1.嵌入内核</strong><br> 
      <br> 
    正文将通过代码介绍如何将 Lysee 嵌入应用程序并用嵌入的 Lysee 执行命令行指定的程序文件。<br>
<br>
嵌入 Lysee 只需 lseu.pas 和 lysee.dll（或lysee.so）两个文件，它们是 Lysee 安装的必要部分，具体位置可以查阅<a href="200.html#folder">安装目录结构</a>。</td> 
  </tr> 
  <tr> 
    <td class="footer_line"><strong>1.1 建立工程</strong><br> 
      <br> 
      启动 <a href="http://www.lazarus.freepascal.org/" target="_blank">Lazarus</a> 后按“Project/New Project ...”的顺序打开建立工程对话框：<br>
      <br>
      <center><img src="images/401/01.png" width="398" height="267"></center><br>
      选择“Console application”类型后按“Create”按钮打开控制台项目设置对话框：<br> 
    <br>
    <center><img src="images/401/02.png" width="466" height="315"></center><br>
    示例程序无须继承 TCustomApplication 类，按“Cancel”按钮生成最为简洁的程序代码：<br>
    <br>
    <center><img src="images/401/03.png" width="568" height="470"></center><br>
    简单整理一下将程序命名保存到 cembed 文件夹中：<br>
    <br>
    <center><img src="images/401/04.png" width="568" height="470"></center><br>
    在继续后面的内容前请编译运行 cembed 确保没有错误。</td> 
  </tr> 
  <tr> 
    <td class="footer_line"><strong>1.2. 嵌入 Lysee</strong><br> 
      <br> 
      进入 Lysee <a href="200.html#folder">安装目录</a>，找到文件 lseu.pas 和 lysee.dll 并将它们复制到 cembed 文件夹。<br>
      <br>
将 lseu.pas 加入 cembed 程序：<br> 
      <br> 
      <center><img src="images/401/05.png" width="568" height="470"></center><br> 
      在启动代码块中加入装载 Lysee 内核并执行退出前清理的函数调用：<br> 
      <br> 
      <center><img src="images/401/06.png" width="573" height="445">
      </center><br> 
    编译运行 cembed 确保没有错误。</td> 
  </tr> 
  <tr> 
    <td class="footer_line"><strong>1.3. 执行文件</strong><br> 
      <br> 
      创建 Lysee 执行引擎（TLseEngine）对象执行命令行文件：<br> 
      <br><center><img src="images/401/07.png" width="573" height="445">
      </center>
      <center>
      </center>
      <br>
编译运行 cembed 确保没有错误。</td> 
  </tr> 
  <tr> 
    <td class="footer_line"><strong>1.4. 完成</strong><br> 
      <br>
      打开一个命令行窗口，测试运行随 Lysee 安装的示例程序：<br>
      <br>
      <table width="600"  border="0" align="center" cellpadding="0" cellspacing="0">
        <tr>
          <td nowrap class="dosprompt">d:\cembed&gt;cembed<br>
Usage:&nbsp;cembed&nbsp;lysee_script_file&nbsp;d:\cembed&gt;cembed&nbsp;hello.ls<br>
File&nbsp;&quot;hello.ls&quot;&nbsp;not&nbsp;exists!<br>

d:\cembed&gt;cembed&nbsp;c:\lysee\demos\hello.ls<br>
Hello&nbsp;world!<br>
d:\cembed&gt;</td>
        </tr>
      </table>
      <br>
      至此对 Lysee 的嵌入已经完成，在后面我们将学习一些更高级的 Lysee 开发技术，包括程序的<a href="402.html">脚本化</a>和数据库的代理访问等。</td> 
  </tr> 
  <tr> 
    <td align="left" class="footer_line">本页最后更新: 2010/07/27 </td> 
  </tr> 
</table> 
</body>
</html>
